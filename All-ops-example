<policies>
    <inbound>
        <base />
        <set-backend-service id="apim-generated-policy" backend-id="myllm-openai-endpoint" />
        <set-variable name="airsDescriptions" value="@{
                return new JObject(
                    new JProperty("url_cats", "There are unacceptable URLs."),
                    new JProperty("dlp", "There is sensitive data."),
                    new JProperty("injection", "This contains content that is interpreted as trying to do something malicious."),
                    new JProperty("agent", "Do not mess with my agent."),
                    new JProperty("toxic_content", "This contains content that is not in keeping with our policy."),
                    new JProperty("malicious_code", "You are not fooling me with your naughty code."),
                    new JProperty("topic_violation", "We are going off topic."),
                    new JProperty("db_security", "Keep out of DB commands."),
                    new JProperty("ungrounded", "We lost the plot.")
                );
            }" />
        <set-variable name="ScanType" value="prompt" />
        <set-variable name="currentProfile" value="prompt-profile" />
        <set-variable name="FailOpen" value="true" />
        <include-fragment fragment-id="panw-airs-scan" />
    </inbound>
    <backend>
        <base />
    </backend>
    <outbound>
        <base />
        <set-variable name="FailOpen" value="false" />
        <set-variable name="ScanType" value="response" />
        <set-variable name="currentProfile" value="response-profile" />
        <include-fragment fragment-id="panw-airs-scan" />
    </outbound>
    <on-error>
        <base />
    </on-error>
</policies>